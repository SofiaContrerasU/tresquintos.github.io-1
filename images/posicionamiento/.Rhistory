y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Vamos por Chile",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot4
ggsave(plot = plot4, "puntos_ideales_vamosporchile.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento No Neutrales
plot5 <- ggplot(filter(d1, party == "No Neutrales"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="No Neutrales",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot5
ggsave(plot = plot5, "puntos_ideales_noneutrales.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Apruebo Dignidad
plot6 <- ggplot(filter(d1, party == "Apruebo Dignidad"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Apruebo Dignidad",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot6
ggsave(plot = plot6, "puntos_ideales_apruebodignidad.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Lista del Pueblo
plot7 <- ggplot(filter(d1, party == "Lista del Pueblo"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Lista del Pueblo",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot7
ggsave(plot = plot7, "puntos_ideales_listadelpueblo.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Pueblos Originarios
plot8 <- ggplot(filter(d1, party == "Pueblos Originarios"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Pueblos Originarios",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot8
ggsave(plot = plot8, "puntos_ideales_pueblosoriginarios.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Lista del Apruebo
plot9 <- ggplot(filter(d1, party == "Lista del Apruebo"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Lista del Apruebo",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot9
ggsave(plot = plot9, "puntos_ideales_lda.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Independientes
plot10 <- ggplot(filter(d1, party == "Independientes"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Otros Independientes",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot10
ggsave(plot = plot10, "puntos_ideales_independientes.png", width = 5, height = 5, units = "in", dpi = 300)
# Dataframe
df_graph <- data.frame(name=rownames(result$legislators),coalicion=result$legislators$party,coord=result$legislators$coord1D,se=result$legislators$se1D)
# Funciones: mean y sd columnas
mean_valid<-function(x){round(mean(na.omit(x)),3)}
sd_valid<-function(x){round(sd(x,na.rm=TRUE),3)}
df_graph$mean_party<-ave(df_graph$coord,df_graph$coalicion,FUN=mean_valid)
df_graph$sd_party<-ave(df_graph$coord,df_graph$coalicion,FUN=sd_valid)
# Crea columna resumen
for (i in 1:length(df_graph$name)){df_graph$gral[i]<-paste0(df_graph$coalicion[i],'\n Prom:',df_graph$mean[i],' (',df_graph$sd[i],')')}
## Add last name
df_graph <- cbind(df_graph, apellidos)
# Plot W-Nominate (individual) 1 Dimensión
plot1 <- df_graph %>%
ggplot(aes(reorder(apellidos,coord), coord, label=apellidos)) +
xlab("Constituyente") + ylab("Izquierda                     Derecha")+
geom_point(stat='identity', aes(col=coalicion), size=2.5) +
scale_color_viridis_d() + coord_flip() +
theme_bw()+
theme(legend.position="top")+
theme(legend.position = c(0.75, 0.3))+
guides(color=guide_legend("Coalición")) +
#geom_errorbar(aes(ymin=coord-se, ymax=coord+se), width=.2,position=position_dodge(0.05))
geom_errorbar(aes(ymin=coord, ymax=coord), width=.2,position=position_dodge(0.05))+
ylim(-1.1, 1.1)+
labs(caption = "Fuente: tresquintos.cl") +
theme(plot.caption=element_text(size=rel(.3)))
plot1
ggsave(plot = plot1, "puntos_ideales_individual.png", width = 5, height = 25, units = "in", dpi = 300)
# Dataframe
df_graph <- data.frame(name=rownames(result$legislators),coalicion=result$legislators$party,coord=result$legislators$coord1D,se=result$legislators$se1D)
# Funciones: mean y sd columnas
mean_valid<-function(x){round(mean(na.omit(x)),3)}
sd_valid<-function(x){round(sd(x,na.rm=TRUE),3)}
df_graph$mean_party<-ave(df_graph$coord,df_graph$coalicion,FUN=mean_valid)
df_graph$sd_party<-ave(df_graph$coord,df_graph$coalicion,FUN=sd_valid)
# Crea columna resumen
for (i in 1:length(df_graph$name)){df_graph$gral[i]<-paste0(df_graph$coalicion[i],'\n Prom:',df_graph$mean[i],' (',df_graph$sd[i],')')}
## Add last name
df_graph <- cbind(df_graph, apellidos)
# Plot W-Nominate (individual) 1 Dimensión
plot1 <- df_graph %>%
ggplot(aes(reorder(apellidos,coord), coord, label=apellidos)) +
xlab("Constituyente") + ylab("Izquierda                     Derecha")+
geom_point(stat='identity', aes(col=coalicion), size=2.5) +
scale_color_viridis_d() + coord_flip() +
theme_bw()+
theme(legend.position="top")+
theme(legend.position = c(0.75, 0.3))+
guides(color=guide_legend("Coalición")) +
#geom_errorbar(aes(ymin=coord-se, ymax=coord+se), width=.2,position=position_dodge(0.05))
geom_errorbar(aes(ymin=coord, ymax=coord), width=.2,position=position_dodge(0.05))+
ylim(-1.1, 1.1)+
labs(caption = "Fuente: tresquintos.cl") +
theme(plot.caption=element_text(size=rel(.3)))
plot1
ggsave(plot = plot1, "puntos_ideales_individual.png", width = 5, height = 25, units = "in", dpi = 300)
## Plot W-Nominate (coalición) 1 Dimensión
plot2 <- df_graph %>%
ggplot(aes(reorder(coalicion,mean_party), coord, label=name)) +
xlab("Coalición") + ylab("Izquierda                                       Derecha")+
geom_point(stat='identity', aes(col=coalicion), size=2,alpha = 0.4,show.legend = FALSE) +
scale_color_viridis_d() +
coord_flip()+
ylim(-1.1, 1.1)+
labs(caption = "Fuente: tresquintos.cl") +
theme(plot.caption=element_text(size=rel(.3)))+
theme_bw()
plot2
ggsave(plot = plot2, "puntos_ideales_coalicion.png", width = 5, height = 5, units = "in", dpi = 300)
library(ggridges)
plot22 <- ggplot(df_graph, aes(x= coord, y = reorder(factor(coalicion), coord))) +
labs(x = "Izquierda                                       Derecha", y = "Coalición") +
labs(caption = "Fuente: tresquintos.cl") +
theme(plot.caption=element_text(size=rel(.3)))+
geom_density_ridges_gradient(scale = .9, gradient_lwd = .5)
plot22
ggsave(plot = plot22, "puntos_ideales_coalicion2.png", width = 5, height = 5, units = "in", dpi = 300)
##############
## Posicionamiento 155 Constituyentes
plot3 <-  ggplot(d1, aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.01) +   # Draw dashed lines
labs(title="Convención Constitucional",
x="Constituyente",
y="Izquierda                                                         Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 1))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot3
ggsave(plot = plot3, "puntos_ideales_nombres2.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Vamos por Chile
plot4 <- ggplot(filter(d1, party == "Vamos por Chile"), aes(x=reorder(label, -coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Vamos por Chile",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot4
ggsave(plot = plot4, "puntos_ideales_vamosporchile.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Vamos por Chile
plot4 <- ggplot(filter(d1, party == "Vamos por Chile"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Vamos por Chile",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot4
ggsave(plot = plot4, "puntos_ideales_vamosporchile.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Vamos por Chile
plot4 <- ggplot(filter(d1, party == "Vamos por Chile"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Vamos por Chile",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot4
ggsave(plot = plot4, "puntos_ideales_vamosporchile.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento No Neutrales
plot5 <- ggplot(filter(d1, party == "No Neutrales"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="No Neutrales",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot5
ggsave(plot = plot5, "puntos_ideales_noneutrales.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Apruebo Dignidad
plot6 <- ggplot(filter(d1, party == "Apruebo Dignidad"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Apruebo Dignidad",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot6
ggsave(plot = plot6, "puntos_ideales_apruebodignidad.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Lista del Pueblo
plot7 <- ggplot(filter(d1, party == "Lista del Pueblo"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Lista del Pueblo",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot7
ggsave(plot = plot7, "puntos_ideales_listadelpueblo.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Pueblos Originarios
plot8 <- ggplot(filter(d1, party == "Pueblos Originarios"), aes(x=reorder(label, -coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Pueblos Originarios",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot8
ggsave(plot = plot8, "puntos_ideales_pueblosoriginarios.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Lista del Apruebo
plot9 <- ggplot(filter(d1, party == "Lista del Apruebo"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Lista del Apruebo",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot9
ggsave(plot = plot9, "puntos_ideales_lda.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Independientes
plot10 <- ggplot(filter(d1, party == "Independientes"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Otros Independientes",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot10
ggsave(plot = plot10, "puntos_ideales_independientes.png", width = 5, height = 5, units = "in", dpi = 300)
## Posicionamiento Independientes
plot10 <- ggplot(filter(d1, party == "Independientes"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Otros Independientes",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot10
ggsave(plot = plot10, "puntos_ideales_independientes.png", width = 5, height = 5, units = "in", dpi = 300)
plot10 <- ggplot(filter(d1, party == "Independientes"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Otros Independientes",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot10
View(d1)
## Posicionamiento Independientes
plot10 <- ggplot(filter(d1, party == "Independiente"), aes(x=reorder(label, coord1D), y=coord1D)) +
geom_point(col="tomato2", size=2) +   # Draw points
geom_segment(aes(x=label,
xend=label,
y=min(-1),
#y=min(coord1D),
yend=max(1)),
#yend=max(coord1D)),
linetype="dashed",
size=0.1) +   # Draw dashed lines
labs(title="Otros Independientes",
x="Constituyente",
y="Izquierda                                       Derecha",
subtitle="Posicionamiento ideológico",
caption="Fuente: tresquintos.cl") +
theme_bw()+
theme(axis.text.y = element_text(size = 6))+
theme(plot.caption=element_text(size=rel(.3)))+
coord_flip()
plot10
ggsave(plot = plot10, "puntos_ideales_independientes.png", width = 5, height = 5, units = "in", dpi = 300)
